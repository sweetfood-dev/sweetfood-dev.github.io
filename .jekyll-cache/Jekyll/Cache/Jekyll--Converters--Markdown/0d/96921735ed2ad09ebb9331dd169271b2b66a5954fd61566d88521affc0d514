I"<p><strong>클로저</strong><br />
<br /></p>

<ol>
  <li>클로저의 형태
    <ul>
      <li>이름을 가진 어떤 값도 캡처하지 않는 <strong>전역 함수</strong></li>
      <li>이름을 가진 자신을 감싸고 있는 함수에서 값을 캡쳐해 가질 수 있는 <strong>중첩 함수</strong></li>
      <li>이름이 없으며 주변 환경의 값을 캡처해 가질 수 있는 <strong>클로저 표현식</strong></li>
    </ul>
  </li>
  <li>@escaping
    <ul>
      <li>인자값으로 전달된 클로저를 저장해 두었다가 다른 곳에서도 실행할 수 있도록 허용해주는 속성</li>
      <li>인자값으로 전달된 클로저는 기본적으로 탈출불가의 성격을 가진다</li>
      <li>이는 <strong>함수 내에서, 직접 실행을 위해서만 사용</strong>해야하는 것을 의미한다</li>
      <li>중첩된 내부 함수에서도 사용이 불가하다</li>
    </ul>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func outerFunc( c: () -&gt; () ) -&gt; () -&gt; (){
    c()
    func innerFunc() {
        c()
    }
		// innerFunc() 안에서 매개변수 c를 호출하고 있기 때문에 에러 발생
    return innerFunc 
}


let inner = outerFunc {
    print("run func")
}


inner()
</code></pre></div></div>

<p>이러한 제약조건을 모두 제거하여 사용 가능 하게 만들어 주는 것이 <strong>@escaping</strong> 속성이다<br />
아래와 같은 상황에서 사용 <br /></p>
<ul>
  <li>완료에 따른 처리</li>
  <li>비동기로 실행 시 함수 사이의 실행 순서를 정할 수 있음
<br />
    <ol>
      <li>값의 캡처</li>
    </ol>
  </li>
  <li>클로저 내부에서 사용되는 외부 변수의 값을 내부적으로 저장, 이를 <strong>캡처</strong>되었다고 한다</li>
  <li>클로저에서의 캡처는 value type이여도 reference 캡처(카피)를 한다. <strong>변수가 사용되는 시점의 값을 캡처</strong></li>
  <li>단, capture list를 이용하면 value 카피로 사용 가능하다.</li>
  <li>value 캡쳐된 값은 클로저안에서 변경이 불가하다</li>
</ul>

<p><strong>Reference Capture</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var anInteger = 42
let testClosure = {
    // anInteger는 capture되는 순간 reference copy됨
    print("Integer is: \(anInteger)")
}
testClosure() // "Integer is 42"
anInteger = 84

testClosure() // "Integer is 84"
</code></pre></div></div>

<p><strong>Value Capture</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var anInteger = 42

let testClosure = { [anInteger] in    
// anInteger는 capture되는 순간 value copy됨
    print("Integer is: \(anInteger)")
}
testClosure() // "Integer is 42"
anInteger = 84

testClosure() // "Integer is 42"

</code></pre></div></div>
:ET